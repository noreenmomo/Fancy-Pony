<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fancy Pony – Minimal Upload</title>
<style>
  body { font-family: Arial, sans-serif; margin: 2rem; background: #fafafa; }
  form { background:#fff; padding:1rem; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,.1); max-width:520px; }
  label { display:block; margin-top:.5rem; }
  input[type="text"], input[type="file"] { width:100%; padding:.55rem; margin-top:.25rem; border:1px solid #ccc; border-radius:6px; }
  button { margin-top:1rem; padding:.7rem 1.1rem; background:#2563eb; color:#fff; border:0; border-radius:6px; cursor:pointer; }
  .msg { margin-top:1rem; }
</style>
</head>
<body>
  <h1>Fancy Pony – Minimal Upload</h1>
  <form id="f" novalidate>
    <label for="name">Your Name</label>
    <input id="name" name="name" type="text" required />

    <label for="file">Choose File (JPG/PNG/PDF)</label>
    <input id="file" name="file" type="file" accept=".jpg,.jpeg,.png,.pdf" required />

    <button type="submit">Upload</button>
  </form>
  <div class="msg" id="msg"></div>

<script>
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyS8EeAEoACk6HqauFS1y44kI7j20xmuTmIJPucYmtnCBBBSiQu_uSZ8vJGftIaHueFvA/exec'; // ← paste your latest /exec here

  const $ = id => document.getElementById(id);
  $('f').addEventListener('submit', async (e)=>{
    e.preventDefault();
    const msg = $('msg');
    msg.textContent = 'Uploading…';

    const file = $('file').files[0];
    if (!file) { msg.textContent = 'Please choose a file.'; return; }

    try {
      const fd = new FormData();
      fd.append('name', $('name').value.trim());
      fd.append('file', file, file.name); // IMPORTANT: field name must be 'file'

      const r = await fetch(SCRIPT_URL, { method:'POST', body: fd }); // no custom headers
      const txt = await r.text();
      let data; try { data = JSON.parse(txt); } catch { throw new Error('Server returned non-JSON'); }
      console.log('server response:', data);

      if (data.ok) {
        msg.innerHTML = `✅ Uploaded. ${data.fileUrl ? `<a href="${data.fileUrl}" target="_blank" rel="noopener">Open file</a>` : ''}`;
        e.target.reset();
      } else {
        msg.textContent = '❌ ' + (data.error || 'Upload failed');
      }
    } catch (err) {
      msg.textContent = '❌ ' + err.message;
      console.error(err);
    }
  });
</script>
</body>
</html>
